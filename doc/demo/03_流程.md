# 流程：資料取得 → 檢核 → 核決放行 → 儀表板呈現

## A. 資料更新與核決流程（事件鏈）
1) 排程啟動（每日/每月/每季，依資料源頻率）
2) 抓取資料源
   - 財報：TWSE OpenAPI（財務報表類端點）
   - ESG：TWSE OpenAPI（ESG 彙總資料端點）或 ESG 平台匯出 Excel
3) 落地 Raw 區（原始檔保存）
4) 產生指紋（SHA-256）並建立「證據項目」
5) 結構化轉換（欄位型別、期間格式、公司代號標準化）
6) 資料品質檢核
   - 缺值/重複
   - 合理區間（例如比率介於 0~1 或 0~100%）
   - 欄位漂移（新增/缺少欄位）
7) 產生「待審版本」
8) 審核者查看：
   - 檢核報告
   - 證據包（原始檔、指紋、處理紀錄）
9) 核決結果
   - 放行：版本狀態 = 已放行，儀表板可讀取
   - 退回：版本狀態 = 退回，需補件或修正處理規則

## B. 儀表板查詢流程（事件鏈）
1) 使用者選公司/期間 → 系統自動選取「最新已放行版本」
2) 讀取版本快照資料（Curated/Mart）
3) 計算衍生指標（毛利率、ROE、職災率等）
4) 呈現圖表與卡片
5) 使用者點選任一數字 → 顯示「來源/批次/指紋/更新時間」
6) 使用者切換上一版本 → 顯示差異與差異原因
